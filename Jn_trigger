pipeline {
    agent any
    stages {
        stage('Site Check') {
            steps { 
                echo "--------Simply cURL of the site-----------------"
                script {
                    final String url = "3.21.54.71"
                    // Verify if curl return html from site
                    def siteNotExists = sh(
                        script: "curl -s $url --max-time 5",
                        returnStatus: true
                    ) as Boolean // Explicit casting needed, because it returns String
                    println siteNotExists
                    if(siteNotExists) {
                        println "Site does not exist :("
                        println "--------Starting Triggerrd job-----------------"
                        build job: '../Infra_pipeline', wait: false  // true 
                        println "Triggerrd job complit. SUCCESS"
                    } else {
                        println "Site exists :)"
                    }                   
                    echo "Title in as expected. SUCCESS"
                }
            }
        }
    }
}
